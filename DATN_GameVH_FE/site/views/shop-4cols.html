<div class="wrap-container" ng-controller="ShopController">
    <div class="image-bg-body"></div>
    <main class="main" ng-controller="CartController">
        <div class="page-header text-center"
            style="background-image: url('../assets/images/page-header-bg3.jpg'); background-position: center center; height: 15em;">
            <div class="container mt-5">
                <h1 class="page-title text-warning" style="text-shadow: 3px 2px #FF0000;">
                    Cửa hàng
                </h1>
            </div>
            <!-- End .container -->
        </div>
        <!-- End .page-header -->
        <nav aria-label="breadcrumb" class="breadcrumb-nav mb-2">
            <div class="container">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">Trang chủ</a></li>
                    <li class="breadcrumb-item active" aria-current="page"><a href="/{{typePageShop}}">Cửa hàng</a></li>
                </ol>
            </div>
            <!-- End .container -->
        </nav>
        <!-- End .breadcrumb-nav -->

        <div class="page-content" ng-controller="WishlistController">
            <div class="container">
                <div class="row">
                    <div class="col-lg-9">
                        <div class="toolbox">
                            <div class="toolbox-left">
                                <div class="toolbox-info">
                                    Đang hiển thị <span>{{products.length < itemsPerPage ? products.length :
                                            itemsPerPage}}</span> Sản phẩm
                                </div>
                                <!-- End .toolbox-info -->
                            </div>
                            <!-- End .toolbox-left -->

                            <div class="toolbox-right">
                                <div class="toolbox-sort">
                                    <label for="sortby">Loại:</label>
                                    <div class="select-custom">
                                        <select name="sortby" id="sortby" class="form-control"
                                            ng-change="fillByType(this)" ng-model="selectedType">
                                            <option value="0" selected>Tất cả</option>
                                            <option value="Game">Game</option>
                                            <option value="PK">Phụ kiện</option>
                                        </select>
                                    </div>
                                </div>
                                <!-- End .toolbox-sort -->
                                <div class="toolbox-layout">
                                    <a href="/shop-list" class="btn-layout">
                                        <svg width="16" height="10">
                                            <rect x="0" y="0" width="4" height="4" />
                                            <rect x="6" y="0" width="10" height="4" />
                                            <rect x="0" y="6" width="4" height="4" />
                                            <rect x="6" y="6" width="10" height="4" />
                                        </svg>
                                    </a>
                                    <a href="/shop-2cols" class="btn-layout"> <svg width="10" height="10">
                                            <rect x="0" y="0" width="4" height="4" />
                                            <rect x="6" y="0" width="4" height="4" />
                                            <rect x="0" y="6" width="4" height="4" />
                                            <rect x="6" y="6" width="4" height="4" />
                                        </svg>
                                    </a>
                                    <a href="/shop" class="btn-layout"> <svg width="16" height="10">
                                            <rect x="0" y="0" width="4" height="4" />
                                            <rect x="6" y="0" width="4" height="4" />
                                            <rect x="12" y="0" width="4" height="4" />
                                            <rect x="0" y="6" width="4" height="4" />
                                            <rect x="6" y="6" width="4" height="4" />
                                            <rect x="12" y="6" width="4" height="4" />
                                        </svg>
                                    </a>
                                    <a href="/shop-4cols" class="btn-layout active"> <svg width="22" height="10">
                                            <rect x="0" y="0" width="4" height="4" />
                                            <rect x="6" y="0" width="4" height="4" />
                                            <rect x="12" y="0" width="4" height="4" />
                                            <rect x="18" y="0" width="4" height="4" />
                                            <rect x="0" y="6" width="4" height="4" />
                                            <rect x="6" y="6" width="4" height="4" />
                                            <rect x="12" y="6" width="4" height="4" />
                                            <rect x="18" y="6" width="4" height="4" />
                                        </svg>
                                    </a>
                                </div>
                                <!-- End .toolbox-layout -->
                            </div>
                            <!-- End .toolbox-right -->
                        </div>
                        <!-- End .toolbox -->

                        <div class="products mb-3">
                            <div class="row justify-content-center">
                                <div ng-if="displayedItems.length === 0">
                                    <p>Không có dữ liệu sản phẩm</p>
                                </div>

                                <div class="col-6 col-md-4 col-lg-4 col-xl-3" ng-if="displayedItems.length > 0"
                                    ng-repeat="item in displayedItems">
                                    <div class="product product-7 text-center">
                                        <figure class="product-media">
                                            <a href="/product/detail/{{item.id}}"> <img
                                                    src="https://drive.google.com/uc?id={{item.poster ? item.poster : '1k7mZ306aaQltWZVJBe-zbXizg2NmAogx'}}"
                                                    alt="Product image" class="product-image">
                                            </a>

                                            <div class="product-action-vertical">
                                                <a href="#" class="btn-product-icon btn-wishlist btn-expandable"
                                                    data-product-id="{{ item.id }}"
                                                    ng-click="toggleFavorite($event)"><span>Thêm vào
                                                        yêu thích</span></a> <a href="popup/quickView.html"
                                                    class="btn-product-icon btn-quickview" title="Xem nhanh"><span>Xem
                                                        nhanh</span></a> <a href="#"
                                                    class="btn-product-icon btn-compare" title="So sánh"><span>So
                                                        sánh</span></a>
                                            </div>
                                            <!-- End .product-action-vertical -->

                                            <div class="product-action">
                                                <a data-product-id="{{item.id}}" ng-click="addCart($event)"
                                                    style="cursor: pointer;" class="btn-product btn-cart"><span>Thêm vào
                                                        giỏ hàng</span></a>
                                            </div>
                                            <!-- End .product-action -->
                                        </figure>
                                        <!-- End .product-media -->

                                        <div class="product-body">
                                            <div class="product-cat">
                                                <a
                                                    href="/{{typePageShop}}/{{item.type}}/{{item.categoryId}}">{{item.categoryName}}</a>
                                            </div>
                                            <!-- End .product-cat -->
                                            <h3 class="product-title">
                                                <a href="/product/detail/{{item.id}}">{{item.name}}</a>
                                            </h3>
                                            <!-- End .product-title -->
                                            <div class="product-price">
                                                <span class="new-price d-block w-100"
                                                    ng-show="{{item.offer <= 0}}">{{item.salePrice | vndFormat}}</span>
                                                <span class="new-price d-block w-100"
                                                    ng-show="{{item.offer > 0}}">{{item.salePrice -
                                                    (item.salePrice * item.offer) | vndFormat}}</span>
                                                <span class="old-price d-block w-100"
                                                    ng-show="{{item.offer > 0}}">{{item.salePrice | vndFormat}}</span>
                                            </div>
                                            <!-- End .product-price -->
                                            <div class="ratings-container" ng-if="item.rate != 0">
                                                <div class="ratings">
                                                    <div class="ratings-val"
                                                        ng-style="{'width': (item.rate * 20) + '%'};">
                                                    </div>
                                                    <!-- End .ratings-val -->
                                                </div>
                                                <!-- End .ratings -->
                                                <span class="ratings-text">(
                                                    {{item.countFeedBack}} Reviews )</span>
                                            </div>
                                            <div class="ratings-container" ng-if="item.rate == 0">
                                                <div class="ratings">
                                                    <div class="ratings-val" style="width: 0%;">
                                                    </div>
                                                    <!-- End .ratings-val -->
                                                </div>
                                                <!-- End .ratings -->
                                                <span class="ratings-text">(
                                                    0 Reviews )</span>
                                            </div>
                                            <!-- End .rating-container -->
                                        </div>
                                        <!-- End .product-body -->
                                    </div>
                                    <!-- End .product -->
                                </div>
                                <!-- End .col-sm-6 col-lg-4 col-xl-3 -->
                            </div>
                            <!-- End .row -->
                        </div>
                        <!-- End .products -->

                        <nav aria-label="Page navigation">
                            <ul class="pagination d-flex justify-content-center">
                                <li class="page-item" ng-class="{ disabled: currentPage === 1 }">
                                    <button class="page-link page-link-prev" aria-label="Previous"
                                        ng-click="previousPage()" tabindex="-1" aria-disabled="{{currentPage === 1}}">
                                        <span aria-hidden="true"><i class="icon-long-arrow-left"></i></span>Trước
                                    </button>
                                </li>
                                <li class="page-item" ng-repeat="pNum in getPageRange(totalPages) track by $index"
                                    ng-class="{ active: ($index + 1) === currentPage }">
                                    <button class="page-link" ng-click="get_ByPage($index + 1)">{{$index + 1}}</button>
                                </li>
                                <li class="page-item-total">của {{totalPages}}</li>
                                <li class="page-item" ng-class="{ disabled: currentPage === totalPages }">
                                    <button class="page-link page-link-next" aria-label="Next" ng-click="nextPage()">Sau
                                        <span aria-hidden="true"><i class="icon-long-arrow-right"></i></span>
                                    </button>
                                </li>
                            </ul>
                        </nav>
                    </div>
                    <!-- End .col-lg-9 -->
                    <aside class="col-lg-3 order-lg-first">
                        <div class="sidebar sidebar-shop">
                            <div class="widget widget-clean">
                                <label>Lọc:</label> <a href="" ng-click="resetFilter()" class="sidebar-filter-clear">Làm
                                    mới</a>
                            </div>
                            <!-- End .widget widget-clean -->

                            <div class="widget widget-collapsible">
                                <h3 class="widget-title">
                                    <a data-toggle="collapse" role="button" aria-expanded="true"
                                        aria-controls="widget-1">Thể Loại </a>
                                </h3>
                                <!-- End .widget-title -->

                                <div class="collapse show" id="widget-1">
                                    <div class="widget-body">
                                        <div class="filter-items filter-items-count">
                                            <h5 class="mt-1">Games</h5>
                                            <div class="filter-item" ng-repeat="(key, value) in categories">
                                                <div class="custom-control custom-checkbox"
                                                    ng-if="value.type == 'Game'">
                                                    <input type="checkbox" class="custom-control-input game"
                                                        id="{{'cat-' + $index}}"
                                                        data-category-id="{{value.categoryId}}">
                                                    <label class="custom-control-label"
                                                        for="{{'cat-' + $index}}">{{value.name}}</label>
                                                </div>
                                                <!-- End .custom-checkbox -->
                                                <!-- <span class="item-count">{{value.qtyProduct}}</span> -->
                                            </div>
                                            <h5 class="mt-2">Phụ kiện</h5>
                                            <div class="filter-item" ng-repeat="(key, value) in categories">
                                                <div class="custom-control custom-checkbox" ng-if="value.type == 'PK'">
                                                    <input type="checkbox" class="custom-control-input pk"
                                                        data-category-id="{{value.categoryId}}"
                                                        id="{{'cat-' + $index}}">
                                                    <label class="custom-control-label"
                                                        for="{{'cat-' + $index}}">{{value.name}}</label>
                                                </div>
                                                <!-- End .custom-checkbox -->
                                                <!-- <span class="item-count">{{value.qtyProduct}}</span> -->
                                            </div>
                                            <!-- End .filter-item -->
                                        </div>
                                        <!-- End .filter-items -->
                                    </div>
                                    <!-- End .widget-body -->
                                </div>
                                <!-- End .collapse -->
                            </div>
                            <!-- End .widget -->

                            <div class="widget widget-collapsible">
                                <h3 class="widget-title">
                                    <a data-toggle="collapse" role="button" aria-expanded="true"
                                        aria-controls="widget-5"> Giá </a>
                                </h3>
                                <!-- End .widget-title -->

                                <div class="collapse show" id="widget-5">
                                    <div class="widget-body">
                                        <div class="filter-price">
                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input rangePrice"
                                                    id="range1" value="0" ng-model="priceRanges[0].selected">
                                                <label class="custom-control-label" for="range1">0 - 1.000.000
                                                    VND</label>
                                            </div>
                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input rangePrice"
                                                    id="range2" value="1000000" ng-model="priceRanges[1].selected">
                                                <label class="custom-control-label" for="range2">1.000.000 - 5.000.000
                                                    VND</label>
                                            </div>
                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input rangePrice"
                                                    id="range3" value="5000000" ng-model="priceRanges[2].selected">
                                                <label class="custom-control-label" for="range3">5.000.000 - 10.000.000
                                                    VND</label>
                                            </div>
                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input rangePrice"
                                                    id="range4" value="10000000" ng-model="priceRanges[3].selected">
                                                <label class="custom-control-label" for="range4">Trên 10.000.000
                                                    VND</label>
                                            </div>
                                            <div class="d-flex mt-3">
                                                <button type="button" class="btn btn-outline-primary-2"
                                                    ng-click="filter()">
                                                    <span>ÁP DỤNG</span> <i class="icon-long-arrow-right"></i>
                                                </button>
                                            </div>
                                            <!-- End #price-slider -->
                                        </div>
                                        <!-- End .filter-price -->
                                    </div>
                                    <!-- End .widget-body -->
                                </div>
                                <!-- End .collapse -->
                            </div>
                            <!-- End .widget -->
                        </div>
                        <!-- End .sidebar sidebar-shop -->
                    </aside>
                    <!-- End .col-lg-3 -->
                </div>
                <!-- End .row -->
            </div>
            <!-- End .container -->
        </div>
        <!-- End .page-content -->
        <div id="toast"></div>
    </main>
</div>